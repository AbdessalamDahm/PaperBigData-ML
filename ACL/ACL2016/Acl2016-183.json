"{\"abstract\":\"For many applications, the query speed of N -gram language models is a computational bottleneck. Although massively parallel hardware like GPUs offer a potential solution to this bottleneck, exploiting this hardware requires a careful rethinking of basic algorithms and data structures. We present the first language model designed for such hardware, using B-trees to maximize data parallelism and minimize memory footprint and latency. Compared with a single-threaded instance of KenLM (Heafield, 2011), a highly optimized CPUbased language model, our GPU implementation produces identical results with a smaller memory footprint and a sixfold increase in throughput on a batch query task. When we saturate both devices, the GPU delivers nearly twice the throughput per hardware dollar even when the CPU implementation uses faster data structures. Our implementation is freely available at\",\"arxivId\":null,\"authors\":[{\"authorId\":\"3444222\",\"name\":\"Nikolay Bogoychev\",\"url\":\"https://www.semanticscholar.org/author/3444222\"},{\"authorId\":\"144871732\",\"name\":\"A. Lopez\",\"url\":\"https://www.semanticscholar.org/author/144871732\"}],\"citationVelocity\":0,\"citations\":[{\"arxivId\":\"1701.03038\",\"authors\":[{\"authorId\":\"145287425\",\"name\":\"David Chiang\"},{\"authorId\":\"3452113\",\"name\":\"Arturo Argueta\"}],\"doi\":\"10.18653/V1/E17-1098\",\"intent\":[\"background\"],\"isInfluential\":false,\"paperId\":\"dafc9715ad6d639229b0e709d0cf4d7e13cbc499\",\"title\":\"Decoding with Finite-State Transducers on GPUs\",\"url\":\"https://www.semanticscholar.org/paper/dafc9715ad6d639229b0e709d0cf4d7e13cbc499\",\"venue\":\"EACL\",\"year\":2017}],\"corpusId\":410278,\"doi\":\"10.18653/v1/P16-1183\",\"fieldsOfStudy\":[\"Computer Science\"],\"influentialCitationCount\":0,\"is_open_access\":true,\"is_publisher_licensed\":true,\"paperId\":\"8f8c0588a7126a03a366b6f30000543ae1211b79\",\"references\":[{\"arxivId\":null,\"authors\":[],\"doi\":null,\"intent\":[],\"isInfluential\":false,\"paperId\":\"\",\"title\":\"Nvidia Corporation. 2015. Nvidia CUDA Compute Unified Device Architecture Programming Guide\",\"url\":\"\",\"venue\":\"\",\"year\":null},{\"arxivId\":null,\"authors\":[{\"authorId\":\"1643845523\",\"name\":\"F. ChenStanley\"},{\"authorId\":\"1643789739\",\"name\":\"GoodmanJoshua\"}],\"doi\":null,\"intent\":[\"background\"],\"isInfluential\":false,\"paperId\":\"d4e8bed3b50a035e1eabad614fe4218a34b3b178\",\"title\":\"An empirical study of smoothing techniques for language modeling\",\"url\":\"https://www.semanticscholar.org/paper/d4e8bed3b50a035e1eabad614fe4218a34b3b178\",\"venue\":\"\",\"year\":1999},{\"arxivId\":null,\"authors\":[{\"authorId\":\"2058713\",\"name\":\"M. Yasuhara\"},{\"authorId\":\"2045011\",\"name\":\"T. Tanaka\"},{\"authorId\":\"3352120\",\"name\":\"Jun-ya Norimatsu\"},{\"authorId\":\"37491468\",\"name\":\"Mikio Yamamoto\"}],\"doi\":null,\"intent\":[\"background\"],\"isInfluential\":false,\"paperId\":\"b6737bc030457fa69f307d312dd33176b4eadc02\",\"title\":\"An Efficient Language Model Using Double-Array Structures\",\"url\":\"https://www.semanticscholar.org/paper/b6737bc030457fa69f307d312dd33176b4eadc02\",\"venue\":\"EMNLP\",\"year\":2013},{\"arxivId\":null,\"authors\":[{\"authorId\":\"1784037\",\"name\":\"T. Brants\"},{\"authorId\":\"2054252\",\"name\":\"A. Popat\"},{\"authorId\":\"145612634\",\"name\":\"Peng Xu\"},{\"authorId\":\"2002316\",\"name\":\"F. Och\"},{\"authorId\":\"49959210\",\"name\":\"J. Dean\"}],\"doi\":null,\"intent\":[\"methodology\"],\"isInfluential\":false,\"paperId\":\"ba786c46373892554b98df42df7af6f5da343c9d\",\"title\":\"Large Language Models in Machine Translation\",\"url\":\"https://www.semanticscholar.org/paper/ba786c46373892554b98df42df7af6f5da343c9d\",\"venue\":\"EMNLP-CoNLL\",\"year\":2007},{\"arxivId\":null,\"authors\":[{\"authorId\":\"1702066\",\"name\":\"Kenneth Heafield\"}],\"doi\":null,\"intent\":[],\"isInfluential\":false,\"paperId\":\"f32d2b405e452db16c0441df9e3db816158f8dce\",\"title\":\"Efficient Language Modeling Algorithms with Applications to Statistical Machine Translation\",\"url\":\"https://www.semanticscholar.org/paper/f32d2b405e452db16c0441df9e3db816158f8dce\",\"venue\":\"\",\"year\":2013},{\"arxivId\":null,\"authors\":[{\"authorId\":\"144251066\",\"name\":\"David Talbot\"},{\"authorId\":\"2057788\",\"name\":\"M. Osborne\"}],\"doi\":null,\"intent\":[\"background\"],\"isInfluential\":false,\"paperId\":\"d05cf3d39f5123b8089cb93b3f0c89137eb11708\",\"title\":\"Smoothed Bloom Filter Language Models: Tera-Scale LMs on the Cheap\",\"url\":\"https://www.semanticscholar.org/paper/d05cf3d39f5123b8089cb93b3f0c89137eb11708\",\"venue\":\"EMNLP-CoNLL\",\"year\":2007},{\"arxivId\":null,\"authors\":[{\"authorId\":\"1702066\",\"name\":\"Kenneth Heafield\"}],\"doi\":null,\"intent\":[\"methodology\",\"background\",\"result\"],\"isInfluential\":true,\"paperId\":\"883d1d06d857a85a0e64bb19f0b17d56f2cc9d7b\",\"title\":\"KenLM: Faster and Smaller Language Model Queries\",\"url\":\"https://www.semanticscholar.org/paper/883d1d06d857a85a0e64bb19f0b17d56f2cc9d7b\",\"venue\":\"WMT@EMNLP\",\"year\":2011},{\"arxivId\":null,\"authors\":[{\"authorId\":\"102811815\",\"name\":\"Marcello Federico\"},{\"authorId\":\"1895952\",\"name\":\"N. Bertoldi\"},{\"authorId\":\"3077970\",\"name\":\"M. Cettolo\"}],\"doi\":null,\"intent\":[],\"isInfluential\":false,\"paperId\":\"93f6dd2c761fdeac0af6d2253d57834439d7794f\",\"title\":\"IRSTLM: an open source toolkit for handling large scale language models\",\"url\":\"https://www.semanticscholar.org/paper/93f6dd2c761fdeac0af6d2253d57834439d7794f\",\"venue\":\"INTERSPEECH\",\"year\":2008},{\"arxivId\":null,\"authors\":[{\"authorId\":\"3185853\",\"name\":\"J. Chong\"},{\"authorId\":\"2308319\",\"name\":\"E. Gonina\"},{\"authorId\":\"1714079\",\"name\":\"Youngmin Yi\"},{\"authorId\":\"1732330\",\"name\":\"K. Keutzer\"}],\"doi\":null,\"intent\":[\"methodology\",\"background\"],\"isInfluential\":true,\"paperId\":\"b5d9796abbd42efac20bd061f01300ab47f5d930\",\"title\":\"A fully data parallel WFST-based large vocabulary continuous speech recognition on a graphics processing unit\",\"url\":\"https://www.semanticscholar.org/paper/b5d9796abbd42efac20bd061f01300ab47f5d930\",\"venue\":\"INTERSPEECH\",\"year\":2009},{\"arxivId\":null,\"authors\":[{\"authorId\":\"48329856\",\"name\":\"S. Green\"},{\"authorId\":\"46724030\",\"name\":\"Daniel Matthew Cer\"},{\"authorId\":\"144783904\",\"name\":\"Christopher D. Manning\"}],\"doi\":\"10.3115/v1/W14-3311\",\"intent\":[\"background\"],\"isInfluential\":false,\"paperId\":\"ba7a15ff12297f72b734c4115a5103b40931f1c8\",\"title\":\"Phrasal: A Toolkit for New Directions in Statistical Machine Translation\",\"url\":\"https://www.semanticscholar.org/paper/ba7a15ff12297f72b734c4115a5103b40931f1c8\",\"venue\":\"WMT@ACL\",\"year\":2014},{\"arxivId\":null,\"authors\":[{\"authorId\":\"143668320\",\"name\":\"W. Hwu\"}],\"doi\":\"10.1016/C2010-0-65709-9\",\"intent\":[\"background\"],\"isInfluential\":false,\"paperId\":\"424b7365be076e53d4d2b837cff7116c8c76b38c\",\"title\":\"GPU Computing Gems Emerald Edition\",\"url\":\"https://www.semanticscholar.org/paper/424b7365be076e53d4d2b837cff7116c8c76b38c\",\"venue\":\"\",\"year\":2011},{\"arxivId\":null,\"authors\":[{\"authorId\":null,\"name\":\"Nvidia Corporation\"}],\"doi\":null,\"intent\":[\"methodology\"],\"isInfluential\":false,\"paperId\":\"\",\"title\":\"Nvidia CUDA Compute Unified Device Architecture Programming Guide. Nvidia Corporation. https://docs.nvidia.com/cuda/cuda-c-programming- guide\",\"url\":\"\",\"venue\":\"Nvidia CUDA Compute Unified Device Architecture Programming Guide. Nvidia Corporation. https://docs.nvidia.com/cuda/cuda-c-programming- guide\",\"year\":2015},{\"arxivId\":null,\"authors\":[{\"authorId\":\"34896921\",\"name\":\"A. Rosenberg\"},{\"authorId\":\"144903260\",\"name\":\"L. Snyder\"}],\"doi\":\"10.1145/319540.319565\",\"intent\":[],\"isInfluential\":false,\"paperId\":\"588bb3764451be9716ffa382dbf0cab9a551692d\",\"title\":\"Time- and space-optimality in B-trees\",\"url\":\"https://www.semanticscholar.org/paper/588bb3764451be9716ffa382dbf0cab9a551692d\",\"venue\":\"TODS\",\"year\":1981},{\"arxivId\":null,\"authors\":[{\"authorId\":\"144533684\",\"name\":\"H. He\"},{\"authorId\":\"145580839\",\"name\":\"J. Lin\"},{\"authorId\":\"144871732\",\"name\":\"A. Lopez\"}],\"doi\":\"10.1162/tacl_a_00124\",\"intent\":[\"methodology\",\"background\"],\"isInfluential\":false,\"paperId\":\"a3fc2700d3ddff04136f90ad21aff305af89a191\",\"title\":\"Gappy Pattern Matching on GPUs for On-Demand Extraction of Hierarchical Translation Grammars\",\"url\":\"https://www.semanticscholar.org/paper/a3fc2700d3ddff04136f90ad21aff305af89a191\",\"venue\":\"Transactions of the Association for Computational Linguistics\",\"year\":2015},{\"arxivId\":null,\"authors\":[{\"authorId\":\"1725180\",\"name\":\"T. H. Cormen\"},{\"authorId\":\"145372049\",\"name\":\"C. Leiserson\"},{\"authorId\":\"1748960\",\"name\":\"R. Rivest\"},{\"authorId\":\"1690758\",\"name\":\"C. Stein\"}],\"doi\":null,\"intent\":[\"background\"],\"isInfluential\":false,\"paperId\":\"611c2c20f6566946694d832e58bfd7b7cb58b66e\",\"title\":\"Introduction to Algorithms, Third Edition\",\"url\":\"https://www.semanticscholar.org/paper/611c2c20f6566946694d832e58bfd7b7cb58b66e\",\"venue\":\"\",\"year\":2009},{\"arxivId\":null,\"authors\":[{\"authorId\":\"3185853\",\"name\":\"J. Chong\"},{\"authorId\":\"1714079\",\"name\":\"Youngmin Yi\"},{\"authorId\":\"27001288\",\"name\":\"A. Faria\"},{\"authorId\":\"143758120\",\"name\":\"Nadathur Satish\"},{\"authorId\":\"1732330\",\"name\":\"K. Keutzer\"}],\"doi\":null,\"intent\":[\"methodology\",\"background\"],\"isInfluential\":false,\"paperId\":\"0aded7617f56b9a2d23f399b89249745bb8afcc4\",\"title\":\"Data-Parallel Large Vocabulary Continuous Speech Recognition on Graphics Processors\",\"url\":\"https://www.semanticscholar.org/paper/0aded7617f56b9a2d23f399b89249745bb8afcc4\",\"venue\":\"\",\"year\":2008},{\"arxivId\":null,\"authors\":[{\"authorId\":null,\"name\":\"J. Chong\"},{\"authorId\":null,\"name\":\"Y. Yi\"},{\"authorId\":null,\"name\":\"A. Faria\"},{\"authorId\":null,\"name\":\"N. R. Satish\"},{\"authorId\":null,\"name\":\"K. Keutzer\"}],\"doi\":null,\"intent\":[\"methodology\",\"background\"],\"isInfluential\":true,\"paperId\":\"\",\"title\":\"Data-parallel large vocabulary continuous\",\"url\":\"\",\"venue\":\"\",\"year\":2008},{\"arxivId\":null,\"authors\":[{\"authorId\":\"79981882\",\"name\":\"R. Bayer\"},{\"authorId\":\"2771609\",\"name\":\"E. McCreight\"}],\"doi\":\"10.1145/1734663.1734671\",\"intent\":[\"methodology\"],\"isInfluential\":false,\"paperId\":\"c83e04853768e172f32910db1f752d75de8124e7\",\"title\":\"Organization and maintenance of large ordered indices\",\"url\":\"https://www.semanticscholar.org/paper/c83e04853768e172f32910db1f752d75de8124e7\",\"venue\":\"SIGFIDET '70\",\"year\":1970},{\"arxivId\":null,\"authors\":[{\"authorId\":\"1993021992\",\"name\":\"Thomas T. Cormen\"},{\"authorId\":\"145372049\",\"name\":\"C. Leiserson\"},{\"authorId\":\"1748960\",\"name\":\"R. Rivest\"}],\"doi\":null,\"intent\":[],\"isInfluential\":false,\"paperId\":\"f01c4e51cb33f4bed8d37832dc1325ec5dedf49d\",\"title\":\"Introduction to Algorithms\",\"url\":\"https://www.semanticscholar.org/paper/f01c4e51cb33f4bed8d37832dc1325ec5dedf49d\",\"venue\":\"\",\"year\":1990},{\"arxivId\":null,\"authors\":[{\"authorId\":\"1768111\",\"name\":\"Taro Watanabe\"},{\"authorId\":\"1783875\",\"name\":\"Hajime Tsukada\"},{\"authorId\":\"34789234\",\"name\":\"Hideki Isozaki\"}],\"doi\":\"10.3115/1667583.1667689\",\"intent\":[\"methodology\"],\"isInfluential\":false,\"paperId\":\"7b11c263dde88960c4ab27c267d5e100b269bf53\",\"title\":\"A Succinct N-gram Language Model\",\"url\":\"https://www.semanticscholar.org/paper/7b11c263dde88960c4ab27c267d5e100b269bf53\",\"venue\":\"ACL/IJCNLP\",\"year\":2009},{\"arxivId\":null,\"authors\":[{\"authorId\":\"1729041\",\"name\":\"J. Canny\"},{\"authorId\":\"145385471\",\"name\":\"David Hall\"},{\"authorId\":\"38666915\",\"name\":\"D. Klein\"}],\"doi\":null,\"intent\":[\"methodology\",\"background\"],\"isInfluential\":true,\"paperId\":\"f6622fadbb57ae285d22de1fc270a12937d630f1\",\"title\":\"A Multi-Teraflop Constituency Parser using GPUs\",\"url\":\"https://www.semanticscholar.org/paper/f6622fadbb57ae285d22de1fc270a12937d630f1\",\"venue\":\"EMNLP\",\"year\":2013},{\"arxivId\":null,\"authors\":[{\"authorId\":\"1768769\",\"name\":\"F. Cesarini\"},{\"authorId\":\"2540925\",\"name\":\"G. Soda\"}],\"doi\":\"10.1016/0020-0190(83)90084-4\",\"intent\":[],\"isInfluential\":false,\"paperId\":\"f767d9d7b892bac19bb99d2f4e83c0da3312cb27\",\"title\":\"An Algorithm to Construct a Compact B-Tree in Case of Ordered Keys\",\"url\":\"https://www.semanticscholar.org/paper/f767d9d7b892bac19bb99d2f4e83c0da3312cb27\",\"venue\":\"Inf. Process. Lett.\",\"year\":1983},{\"arxivId\":null,\"authors\":[{\"authorId\":\"2057788\",\"name\":\"M. Osborne\"},{\"authorId\":\"70058312\",\"name\":\"A. Lall\"},{\"authorId\":\"7536576\",\"name\":\"Benjamin Van Durme\"}],\"doi\":\"10.3115/v1/P14-2112\",\"intent\":[\"methodology\"],\"isInfluential\":false,\"paperId\":\"bdcbbd927f33a4967b66aa0253cbf3804fdc5ca4\",\"title\":\"Exponential Reservoir Sampling for Streaming Language Models\",\"url\":\"https://www.semanticscholar.org/paper/bdcbbd927f33a4967b66aa0253cbf3804fdc5ca4\",\"venue\":\"ACL\",\"year\":2014},{\"arxivId\":null,\"authors\":[{\"authorId\":\"1702066\",\"name\":\"Kenneth Heafield\"},{\"authorId\":\"1745678\",\"name\":\"Rohan Kshirsagar\"},{\"authorId\":\"49550805\",\"name\":\"Santiago Barona\"}],\"doi\":\"10.3115/v1/P15-2063\",\"intent\":[\"methodology\"],\"isInfluential\":false,\"paperId\":\"70221d07010f0db7b82e826ba2a12442eb5e4fc4\",\"title\":\"Language Identification and Modeling in Specialized Hardware\",\"url\":\"https://www.semanticscholar.org/paper/70221d07010f0db7b82e826ba2a12442eb5e4fc4\",\"venue\":\"ACL\",\"year\":2015},{\"arxivId\":null,\"authors\":[{\"authorId\":\"34370320\",\"name\":\"D. Hall\"},{\"authorId\":\"1400419309\",\"name\":\"Taylor Berg-Kirkpatrick\"},{\"authorId\":\"38666915\",\"name\":\"D. Klein\"}],\"doi\":\"10.3115/v1/P14-1020\",\"intent\":[\"methodology\",\"background\"],\"isInfluential\":true,\"paperId\":\"1e9febd1a88c44843e5f865c3b679174688b1d27\",\"title\":\"Sparser, Better, Faster GPU Parsing\",\"url\":\"https://www.semanticscholar.org/paper/1e9febd1a88c44843e5f865c3b679174688b1d27\",\"venue\":\"ACL\",\"year\":2014}],\"title\":\"N-gram language models for massively parallel devices\",\"topics\":[{\"topic\":\"Language model\",\"topicId\":\"26812\",\"url\":\"https://www.semanticscholar.org/topic/26812\"},{\"topic\":\"Graphics processing unit\",\"topicId\":\"8807\",\"url\":\"https://www.semanticscholar.org/topic/8807\"},{\"topic\":\"Data structure\",\"topicId\":\"3949\",\"url\":\"https://www.semanticscholar.org/topic/3949\"},{\"topic\":\"Xeon Phi\",\"topicId\":\"82044\",\"url\":\"https://www.semanticscholar.org/topic/82044\"},{\"topic\":\"Dynamic programming\",\"topicId\":\"10893\",\"url\":\"https://www.semanticscholar.org/topic/10893\"},{\"topic\":\"SIMD\",\"topicId\":\"8805\",\"url\":\"https://www.semanticscholar.org/topic/8805\"},{\"topic\":\"Parsing\",\"topicId\":\"1910\",\"url\":\"https://www.semanticscholar.org/topic/1910\"},{\"topic\":\"Memory footprint\",\"topicId\":\"158486\",\"url\":\"https://www.semanticscholar.org/topic/158486\"},{\"topic\":\"Search algorithm\",\"topicId\":\"12313\",\"url\":\"https://www.semanticscholar.org/topic/12313\"},{\"topic\":\"Parallel computing\",\"topicId\":\"901\",\"url\":\"https://www.semanticscholar.org/topic/901\"},{\"topic\":\"Throughput\",\"topicId\":\"316\",\"url\":\"https://www.semanticscholar.org/topic/316\"},{\"topic\":\"B-tree\",\"topicId\":\"212538\",\"url\":\"https://www.semanticscholar.org/topic/212538\"},{\"topic\":\"N-gram\",\"topicId\":\"236768\",\"url\":\"https://www.semanticscholar.org/topic/236768\"},{\"topic\":\"Batch processing\",\"topicId\":\"138\",\"url\":\"https://www.semanticscholar.org/topic/138\"},{\"topic\":\"Data parallelism\",\"topicId\":\"13090\",\"url\":\"https://www.semanticscholar.org/topic/13090\"},{\"topic\":\"Thread (computing)\",\"topicId\":\"6051\",\"url\":\"https://www.semanticscholar.org/topic/6051\"},{\"topic\":\"Rico\",\"topicId\":\"70398\",\"url\":\"https://www.semanticscholar.org/topic/70398\"},{\"topic\":\"Canny edge detector\",\"topicId\":\"98812\",\"url\":\"https://www.semanticscholar.org/topic/98812\"},{\"topic\":\"Central processing unit\",\"topicId\":\"2752\",\"url\":\"https://www.semanticscholar.org/topic/2752\"},{\"topic\":\"List of Sega arcade system boards\",\"topicId\":\"1379678\",\"url\":\"https://www.semanticscholar.org/topic/1379678\"},{\"topic\":\"Word lists by frequency\",\"topicId\":\"284043\",\"url\":\"https://www.semanticscholar.org/topic/284043\"},{\"topic\":\"Clara Oswald\",\"topicId\":\"3930136\",\"url\":\"https://www.semanticscholar.org/topic/3930136\"},{\"topic\":\"Clara.io\",\"topicId\":\"1950004\",\"url\":\"https://www.semanticscholar.org/topic/1950004\"}],\"url\":\"https://www.semanticscholar.org/paper/8f8c0588a7126a03a366b6f30000543ae1211b79\",\"venue\":\"ACL\",\"year\":2016}\n"