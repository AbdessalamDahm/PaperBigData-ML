"{\"abstract\":\"Estimating the normalization constants (partition functions) of energy-based probabilistic models (Markov random fields) with a high accuracy is required for measuring performance, monitoring the training progress of adaptive models, and conducting likelihood ratio tests. We devised a unifying theoretical framework for algorithms for estimating the partition function, including Annealed Importance Sampling (AIS) and Bennett\\u2019s Acceptance Ratio method (BAR). The unification reveals conceptual similarities of and differences between different approaches and suggests new algorithms. The framework is based on a generalized form of Crooks\\u2019 equality, which links the expectation over a distribution of samples generated by a transition operator to the expectation over the distribution induced by the reversed operator. Different ways of sampling, such as parallel tempering and path sampling, are covered by the framework. We performed experiments in which we estimated the partition function of restricted Boltzmann machines (RBMs) and Ising models. We found that BAR using parallel tempering worked well with a small number of bridging distributions, while path sampling based AIS performed best with many bridging distributions. The normalization constant is measured w.r.t. a reference distribution, and the choice of this distribution turned out to be very important in our experiments. Overall, BAR gave the best empirical results, outperforming AIS.\",\"arxivId\":null,\"authors\":[{\"authorId\":\"34578133\",\"name\":\"O. Krause\",\"url\":\"https://www.semanticscholar.org/author/34578133\"},{\"authorId\":\"35988982\",\"name\":\"Asja Fischer\",\"url\":\"https://www.semanticscholar.org/author/35988982\"},{\"authorId\":\"153130067\",\"name\":\"C. Igel\",\"url\":\"https://www.semanticscholar.org/author/153130067\"}],\"citationVelocity\":0,\"citations\":[],\"corpusId\":220484105,\"doi\":\"10.24963/ijcai.2020/704\",\"fieldsOfStudy\":[\"Computer Science\"],\"influentialCitationCount\":0,\"is_open_access\":false,\"is_publisher_licensed\":false,\"paperId\":\"0d846285ab9086e6b8f3abf1b11e826a65dbde8f\",\"references\":[{\"arxivId\":null,\"authors\":[{\"authorId\":null,\"name\":\"Yann LeCun\"},{\"authorId\":null,\"name\":\"L\\u00e9on Bottou\"},{\"authorId\":null,\"name\":\"Yoshua Bengio\"},{\"authorId\":null,\"name\":\"Patrick Haffner. Gradient-based learning applied to docume recognition\"}],\"doi\":null,\"intent\":[\"result\"],\"isInfluential\":false,\"paperId\":\"\",\"title\":\"Proceedings of the IEEE\",\"url\":\"\",\"venue\":\"86(11):2278\\u20132324,\",\"year\":1998},{\"arxivId\":null,\"authors\":[{\"authorId\":null,\"name\":\"Oswin Krause\"},{\"authorId\":null,\"name\":\"Asja Fischer\"},{\"authorId\":null,\"name\":\"Christian Igel. Algorithms for estimating the partition func machines\"}],\"doi\":null,\"intent\":[\"methodology\",\"background\",\"result\"],\"isInfluential\":true,\"paperId\":\"\",\"title\":\"Artificial Intelligence Journal\",\"url\":\"\",\"venue\":\"278,\",\"year\":2020},{\"arxivId\":null,\"authors\":[{\"authorId\":\"2623914\",\"name\":\"C. H. Bennett\"}],\"doi\":\"10.1016/0021-9991(76)90078-4\",\"intent\":[],\"isInfluential\":false,\"paperId\":\"58f2b66311def69160cb4d9a900fca0e3fdd5df0\",\"title\":\"Efficient estimation of free energy differences from Monte Carlo data\",\"url\":\"https://www.semanticscholar.org/paper/58f2b66311def69160cb4d9a900fca0e3fdd5df0\",\"venue\":\"\",\"year\":1976},{\"arxivId\":null,\"authors\":[{\"authorId\":\"98241663\",\"name\":\"M. V. Rossum\"}],\"doi\":\"10.1142/9789814360784_0003\",\"intent\":[\"methodology\"],\"isInfluential\":false,\"paperId\":\"2d5af1ab6368f20a4a9bb2afae23663e5b08b9c6\",\"title\":\"Neural Computation\",\"url\":\"https://www.semanticscholar.org/paper/2d5af1ab6368f20a4a9bb2afae23663e5b08b9c6\",\"venue\":\"\",\"year\":1989},{\"arxivId\":null,\"authors\":[{\"authorId\":\"35988982\",\"name\":\"Asja Fischer\"},{\"authorId\":\"1748824\",\"name\":\"C. Igel\"}],\"doi\":\"10.1016/J.PATCOG.2013.05.025\",\"intent\":[\"methodology\"],\"isInfluential\":false,\"paperId\":\"e1a1c3d3e0336d6bfc48fd480a9d18a4f92edc60\",\"title\":\"Training restricted Boltzmann machines: An introduction\",\"url\":\"https://www.semanticscholar.org/paper/e1a1c3d3e0336d6bfc48fd480a9d18a4f92edc60\",\"venue\":\"Pattern Recognit.\",\"year\":2014},{\"arxivId\":null,\"authors\":[],\"doi\":null,\"intent\":[\"background\"],\"isInfluential\":false,\"paperId\":\"\",\"title\":\"Physical Review E\",\"url\":\"\",\"venue\":\"\",\"year\":1995},{\"arxivId\":null,\"authors\":[{\"authorId\":\"47362268\",\"name\":\"Qiang Liu\"},{\"authorId\":\"144439558\",\"name\":\"J. Peng\"},{\"authorId\":\"1740137\",\"name\":\"A. Ihler\"},{\"authorId\":\"31496901\",\"name\":\"John W. Fisher III\"}],\"doi\":null,\"intent\":[],\"isInfluential\":false,\"paperId\":\"3e323d173c347e514f85fda7adb01ba0582489a1\",\"title\":\"Estimating the Partition Function by Discriminance Sampling\",\"url\":\"https://www.semanticscholar.org/paper/3e323d173c347e514f85fda7adb01ba0582489a1\",\"venue\":\"UAI\",\"year\":2015},{\"arxivId\":null,\"authors\":[{\"authorId\":\"1944614\",\"name\":\"Hannes Schulz\"},{\"authorId\":\"143853520\",\"name\":\"A. M\\u00fcller\"},{\"authorId\":\"1699019\",\"name\":\"Sven Behnke\"}],\"doi\":null,\"intent\":[],\"isInfluential\":false,\"paperId\":\"80aa4e1c6f744d50ec9ddc327b7077bc4628be89\",\"title\":\"Investigating Convergence of Restricted Boltzmann Machine Learning\",\"url\":\"https://www.semanticscholar.org/paper/80aa4e1c6f744d50ec9ddc327b7077bc4628be89\",\"venue\":\"\",\"year\":2010},{\"arxivId\":null,\"authors\":[{\"authorId\":\"145162071\",\"name\":\"A. Blake\"},{\"authorId\":\"143967473\",\"name\":\"Pushmeet Kohli\"},{\"authorId\":\"1756036\",\"name\":\"C. Rother\"}],\"doi\":\"10.7551/mitpress/8579.001.0001\",\"intent\":[\"background\"],\"isInfluential\":false,\"paperId\":\"22352ffef6a995aa0b265ba49a92832df09b0734\",\"title\":\"Markov Random Fields for Vision and Image Processing\",\"url\":\"https://www.semanticscholar.org/paper/22352ffef6a995aa0b265ba49a92832df09b0734\",\"venue\":\"\",\"year\":2011},{\"arxivId\":null,\"authors\":[{\"authorId\":\"1695689\",\"name\":\"Geoffrey E. Hinton\"}],\"doi\":\"10.1162/089976602760128018\",\"intent\":[],\"isInfluential\":false,\"paperId\":\"9360e5ce9c98166bb179ad479a9d2919ff13d022\",\"title\":\"Training Products of Experts by Minimizing Contrastive Divergence\",\"url\":\"https://www.semanticscholar.org/paper/9360e5ce9c98166bb179ad479a9d2919ff13d022\",\"venue\":\"Neural Computation\",\"year\":2002},{\"arxivId\":null,\"authors\":[{\"authorId\":\"143817739\",\"name\":\"J. Leeuwen\"},{\"authorId\":\"1714183\",\"name\":\"C. Blundo\"},{\"authorId\":\"1749870\",\"name\":\"C. Laneve\"},{\"authorId\":\"143817739\",\"name\":\"J. Leeuwen\"}],\"doi\":\"10.1007/b13810\",\"intent\":[\"result\"],\"isInfluential\":false,\"paperId\":\"524f2ec5811aa0e9a6aea053c75488d9b83bb170\",\"title\":\"Theoretical Computer Science\",\"url\":\"https://www.semanticscholar.org/paper/524f2ec5811aa0e9a6aea053c75488d9b83bb170\",\"venue\":\"Lecture Notes in Computer Science\",\"year\":2003},{\"arxivId\":null,\"authors\":[{\"authorId\":\"2185200\",\"name\":\"J. Eccleston\"}],\"doi\":\"10.1007/11222.1573-1375\",\"intent\":[\"methodology\"],\"isInfluential\":false,\"paperId\":\"2f5854fe73ced2093c6d0f5d3143fe5135dd3260\",\"title\":\"Statistics and Computing\",\"url\":\"https://www.semanticscholar.org/paper/2f5854fe73ced2093c6d0f5d3143fe5135dd3260\",\"venue\":\"\",\"year\":1999},{\"arxivId\":null,\"authors\":[{\"authorId\":null,\"name\":\"Charles H. Bennett. Efficient estimation of free energy di data\"}],\"doi\":null,\"intent\":[\"methodology\"],\"isInfluential\":false,\"paperId\":\"\",\"title\":\"Journal of Computational Physics\",\"url\":\"\",\"venue\":\"22(2):245 \\u2013 268,\",\"year\":1976},{\"arxivId\":null,\"authors\":[{\"authorId\":null,\"name\":\"Ruslan Salakhutdinov\"},{\"authorId\":null,\"name\":\"Iain Murray. On the quantitative analysis of deep belie networks\"}],\"doi\":null,\"intent\":[\"methodology\",\"background\"],\"isInfluential\":true,\"paperId\":\"\",\"title\":\"In Proceedings of the 25th International Conference on Machine Learning (ICML)\",\"url\":\"\",\"venue\":\"pages 872\\u2013879, New York, NY, USA,\",\"year\":2008},{\"arxivId\":null,\"authors\":[{\"authorId\":\"1876131\",\"name\":\"C. Geyer\"}],\"doi\":null,\"intent\":[],\"isInfluential\":false,\"paperId\":\"653439f31a391423b76f2c870d91d77ccc4c1ed2\",\"title\":\"Estimating Normalizing Constants and Reweighting Mixtures\",\"url\":\"https://www.semanticscholar.org/paper/653439f31a391423b76f2c870d91d77ccc4c1ed2\",\"venue\":\"\",\"year\":1994},{\"arxivId\":null,\"authors\":[{\"authorId\":\"102278025\",\"name\":\"Ross Kindermann\"},{\"authorId\":\"34296841\",\"name\":\"J. Snell\"}],\"doi\":\"10.1090/conm/001\",\"intent\":[\"background\"],\"isInfluential\":false,\"paperId\":\"870234e41be333eb8ab128cbd1ca1623838b8d7f\",\"title\":\"Markov Random Fields and Their Applications\",\"url\":\"https://www.semanticscholar.org/paper/870234e41be333eb8ab128cbd1ca1623838b8d7f\",\"venue\":\"\",\"year\":1980},{\"arxivId\":null,\"authors\":[{\"authorId\":\"10030181\",\"name\":\"Zhalama\"},{\"authorId\":\"1917353\",\"name\":\"J. Zhang\"},{\"authorId\":\"2416067\",\"name\":\"F. Eberhardt\"},{\"authorId\":\"144962049\",\"name\":\"W. Mayer\"}],\"doi\":null,\"intent\":[\"methodology\",\"background\"],\"isInfluential\":false,\"paperId\":\"f5e1af2a9216fa70a763958f3602b075afe3a4aa\",\"title\":\"Proceedings of the 33rd Conference on Uncertainty in Artificial Intelligence (UAI)\",\"url\":\"https://www.semanticscholar.org/paper/f5e1af2a9216fa70a763958f3602b075afe3a4aa\",\"venue\":\"\",\"year\":2017},{\"arxivId\":null,\"authors\":[{\"authorId\":\"2755582\",\"name\":\"G. Desjardins\"},{\"authorId\":\"1760871\",\"name\":\"Aaron C. Courville\"},{\"authorId\":\"1751762\",\"name\":\"Yoshua Bengio\"},{\"authorId\":\"145467703\",\"name\":\"P. Vincent\"},{\"authorId\":\"2460212\",\"name\":\"Olivier Delalleau\"}],\"doi\":null,\"intent\":[],\"isInfluential\":false,\"paperId\":\"83b625ae40c921c47255da5f2e24266e75a48d9b\",\"title\":\"Tempered Markov Chain Monte Carlo for training of Restricted Boltzmann Machines\",\"url\":\"https://www.semanticscholar.org/paper/83b625ae40c921c47255da5f2e24266e75a48d9b\",\"venue\":\"AISTATS\",\"year\":2010},{\"arxivId\":null,\"authors\":[{\"authorId\":null,\"name\":\"H Bennett Charles\"},{\"authorId\":null,\"name\":\"Bennett\"},{\"authorId\":null,\"name\":\"Blake\"}],\"doi\":null,\"intent\":[],\"isInfluential\":false,\"paperId\":\"\",\"title\":\"Oswin Krause, Asja Fischer, and Christian Igel. Algorithms for estimating the partition function of restricted Boltzmann machines\",\"url\":\"\",\"venue\":\"Proceedings of the Twenty-Ninth International Joint Conference on Artificial Intelligence (IJCAI-20) Journal Track [Fischer and Igel, 2015] Asja Fischer and Christian Igel. A bound for the convergence rate of parallel tempering for sampling restricted Boltzmann machines\",\"year\":1976},{\"arxivId\":null,\"authors\":[{\"authorId\":\"1727849\",\"name\":\"S. Hanson\"}],\"doi\":null,\"intent\":[\"methodology\"],\"isInfluential\":false,\"paperId\":\"69d7086300e7f5322c06f2f242a565b3a182efb5\",\"title\":\"In Advances in Neural Information Processing Systems\",\"url\":\"https://www.semanticscholar.org/paper/69d7086300e7f5322c06f2f242a565b3a182efb5\",\"venue\":\"NIPS 1990\",\"year\":1990},{\"arxivId\":null,\"authors\":[{\"authorId\":null,\"name\":\"October I\"}],\"doi\":null,\"intent\":[\"methodology\"],\"isInfluential\":false,\"paperId\":\"ed3b54d37c91ccaf7b059e217d1c91deab042e71\",\"title\":\"Physical Review Letters\",\"url\":\"https://www.semanticscholar.org/paper/ed3b54d37c91ccaf7b059e217d1c91deab042e71\",\"venue\":\"\",\"year\":null},{\"arxivId\":null,\"authors\":[{\"authorId\":null,\"name\":\"Christian Igel\"},{\"authorId\":null,\"name\":\"Tobias Glasmachers\"},{\"authorId\":null,\"name\":\"Verena Heidrich-Meisner. Shark\"}],\"doi\":null,\"intent\":[\"methodology\"],\"isInfluential\":false,\"paperId\":\"\",\"title\":\"Journal of Machine Learning Research\",\"url\":\"\",\"venue\":\"9:993\\u2013996,\",\"year\":2008},{\"arxivId\":null,\"authors\":[{\"authorId\":\"2097256\",\"name\":\"Xiao-Li Meng\"},{\"authorId\":\"144932570\",\"name\":\"W. Wong\"}],\"doi\":null,\"intent\":[\"methodology\"],\"isInfluential\":false,\"paperId\":\"93ef041c254dc6bf140c9382614d8729a1f68bf7\",\"title\":\"SIMULATING RATIOS OF NORMALIZING CONSTANTS VIA A SIMPLE IDENTITY: A THEORETICAL EXPLORATION\",\"url\":\"https://www.semanticscholar.org/paper/93ef041c254dc6bf140c9382614d8729a1f68bf7\",\"venue\":\"\",\"year\":1996},{\"arxivId\":null,\"authors\":[{\"authorId\":\"2694655\",\"name\":\"M. Shirts\"},{\"authorId\":\"144929928\",\"name\":\"E. Bair\"},{\"authorId\":\"145403451\",\"name\":\"G. Hooker\"},{\"authorId\":\"1806271\",\"name\":\"V. Pande\"}],\"doi\":\"10.1103/PHYSREVLETT.91.140601\",\"intent\":[],\"isInfluential\":false,\"paperId\":\"b521eed4d56c9bcc47e356fea0e2eea6818b5587\",\"title\":\"Equilibrium free energies from nonequilibrium measurements using maximum-likelihood methods.\",\"url\":\"https://www.semanticscholar.org/paper/b521eed4d56c9bcc47e356fea0e2eea6818b5587\",\"venue\":\"Physical review letters\",\"year\":2003},{\"arxivId\":null,\"authors\":[{\"authorId\":null,\"name\":\"Charles J. Geyer. Estimating normalizing constants\"},{\"authorId\":null,\"name\":\"reweighting mixtures\"}],\"doi\":null,\"intent\":[\"methodology\"],\"isInfluential\":false,\"paperId\":\"\",\"title\":\"Technical Report 568\",\"url\":\"\",\"venue\":\"School of Statistics, University of Minnesota,\",\"year\":1994},{\"arxivId\":\"1611.04273\",\"authors\":[{\"authorId\":\"3374063\",\"name\":\"Yuhuai Wu\"},{\"authorId\":\"3080409\",\"name\":\"Yuri Burda\"},{\"authorId\":\"145124475\",\"name\":\"R. Salakhutdinov\"},{\"authorId\":\"1785346\",\"name\":\"Roger B. Grosse\"}],\"doi\":null,\"intent\":[\"background\",\"result\"],\"isInfluential\":false,\"paperId\":\"858dc7408c27702ec42778599fc8d11f73ef3f76\",\"title\":\"On the Quantitative Analysis of Decoder-Based Generative Models\",\"url\":\"https://www.semanticscholar.org/paper/858dc7408c27702ec42778599fc8d11f73ef3f76\",\"venue\":\"ICLR\",\"year\":2017},{\"arxivId\":null,\"authors\":[{\"authorId\":null,\"name\":\"Guillaume Desjardins\"},{\"authorId\":null,\"name\":\"C Aaron\"}],\"doi\":null,\"intent\":[],\"isInfluential\":false,\"paperId\":\"\",\"title\":\"Courville , and Yoshua Bengio . On tracking the partition function\",\"url\":\"\",\"venue\":\"Interna - tional Conference on Artificial Intelligence and Statistics ( AISTATS )\",\"year\":null},{\"arxivId\":\"cond-mat/9908420\",\"authors\":[{\"authorId\":\"2459479\",\"name\":\"G. Crooks\"}],\"doi\":\"10.1103/PhysRevE.61.2361\",\"intent\":[],\"isInfluential\":false,\"paperId\":\"5457657eda03c6022481798f04d78352e48d35d1\",\"title\":\"Path-ensemble averages in systems driven far from equilibrium\",\"url\":\"https://www.semanticscholar.org/paper/5457657eda03c6022481798f04d78352e48d35d1\",\"venue\":\"\",\"year\":2000},{\"arxivId\":\"math/0511216\",\"authors\":[{\"authorId\":\"1764325\",\"name\":\"R. Neal\"}],\"doi\":null,\"intent\":[\"methodology\"],\"isInfluential\":false,\"paperId\":\"2a16f8053b7e66aa4081bd3d6c938df1ff8af28a\",\"title\":\"Estimating Ratios of Normalizing Constants Using Linked Importance Sampling\",\"url\":\"https://www.semanticscholar.org/paper/2a16f8053b7e66aa4081bd3d6c938df1ff8af28a\",\"venue\":\"\",\"year\":2005},{\"arxivId\":null,\"authors\":[{\"authorId\":\"34578133\",\"name\":\"O. Krause\"},{\"authorId\":\"35988982\",\"name\":\"Asja Fischer\"},{\"authorId\":\"153130067\",\"name\":\"C. Igel\"}],\"doi\":\"10.1016/j.artint.2019.103195\",\"intent\":[],\"isInfluential\":false,\"paperId\":\"0249b168300a5adb2bfef84d97ddffe8a9427aac\",\"title\":\"Algorithms for estimating the partition function of restricted Boltzmann machines\",\"url\":\"https://www.semanticscholar.org/paper/0249b168300a5adb2bfef84d97ddffe8a9427aac\",\"venue\":\"Artif. Intell.\",\"year\":2020}],\"title\":\"Algorithms for Estimating the Partition Function of Restricted Boltzmann Machines (Extended Abstract)\",\"topics\":[{\"topic\":\"Algorithm\",\"topicId\":\"305\",\"url\":\"https://www.semanticscholar.org/topic/305\"}],\"url\":\"https://www.semanticscholar.org/paper/0d846285ab9086e6b8f3abf1b11e826a65dbde8f\",\"venue\":\"IJCAI\",\"year\":2020}\n"