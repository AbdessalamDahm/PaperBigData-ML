"{\"abstract\":\"Weighted Model Integration (WMI) is a popular technique for probabilistic inference that extends Weighted Model Counting (WMC) \\u2013 the standard inference technique for inference in discrete domains \\u2013 to domains with both discrete and continuous variables. However, existing WMI solvers each have different interfaces and use different formats for representing WMI problems. Therefore, we introduce pywmi, an open source framework and toolbox for probabilistic inference using WMI, to address these shortcomings. Crucially, pywmi fixes a common internal format for WMI problems and introduces a common interface for WMI solvers. To assist users in modeling WMI problems, pywmi introduces modeling languages based on SMT-LIB.v2 or MiniZinc and parsers for these languages. To assist users in comparing WMI solvers, pywmi includes implementations of several state-of-the-art solvers, a fast approximate WMI solver, and a command-line interface to solve WMI problems. Finally, to assist developers in implementing new solvers, pywmi provides Python implementations of commonly used subroutines. 1 Modeling WMI problems In a nutshell, WMI [Belle et al., 2015] traces back to SAT, the problem of deciding if a Boolean formula is satisfiable. #SAT builds on SAT but answers the question of how many models satisfy a formula and WMC extends #SAT by allowing models to be weighted. Like SMT(LRA) extends SAT to answer satisfiability for logical formulas with linear inequalities over real variables, WMI extends WMC to integrate over (instead of summing) over the (possibily infinitely many) weighted models of an SMT(LRA) formula. A WMI problem consists of a support \\u03c6, an SMT(LRA) formula that describes all feasible worlds, a weight function w : R\\u00d7B 7\\u2192 R that assigns a weight to every possible world and a set of queries, every query being an SMT(LRA) formula whose probability we \\u2217Contact Author Figure 1: An overview of the pywmi framework. The language decouples specific modeling languages (top) and solvers (bottom) using a generic format and solver interface, as well as providing command-line interface and tools for solvers. want to compute. Worlds are value assignments to the problem variables. Internally, pywmi represents WMI problems as tuples \\u3008dom, \\u03c6, w,Q\\u3009. The domain dom contains problem variables, their types and, optionally, the valid ranges for numeric variables (e.g., x \\u2208 [0, 1]). Both SMT(LRA) formulas (\\u03c6, q \\u2208 Q) and weight functions (w) are represented as Abstract Syntax Trees (ASTs) using the implementation provided by the PySMT library [Gario and Micheli, 2015]. The internal representation is exposed to developers and, for example, probabilistic programming languages can interface with it. For example, a language such as Problog [Dries et al., 2015] produces ground programs to be solved using WMC, an extension with continuous variables can solve ground programs using WMI instead. However, for endusers, pywmi also provides two modeling languages for WMI problems that can be directly parsed to the pywmi representation (see Figure 1 for an overview). Both formats can be used to compactly encode a WMI problem, differing in the syntax used for the expressions (inspired by MiniZinc [Nethercote et al., 2007] or SMT-LIB.v2 [Barrett et al., 2010]). As an example, consider modelling a factory that produces banana and chocolate flavoured ice cream. Figure 2 shows a toy model of the factory production in the MiniZinc-inspired syntax. Variables b and c represent the amount of banana and chocolate ice cream produced in a work day by the factory, while weekday is a Boolean variable distinguishing between 1 var float : b; % banana-flavoured ice cream 2 var float : c; % chocolate-flavoured ice cream 3 var bool : weekday; % weekday or weekend\",\"arxivId\":null,\"authors\":[{\"authorId\":\"30698192\",\"name\":\"Samuel Kolb\",\"url\":\"https://www.semanticscholar.org/author/30698192\"},{\"authorId\":\"2047325\",\"name\":\"Paolo Morettin\",\"url\":\"https://www.semanticscholar.org/author/2047325\"},{\"authorId\":\"51007563\",\"name\":\"Pedro Zuidberg Dos Martires\",\"url\":\"https://www.semanticscholar.org/author/51007563\"},{\"authorId\":\"108211160\",\"name\":\"F. Sommavilla\",\"url\":\"https://www.semanticscholar.org/author/108211160\"},{\"authorId\":\"145896191\",\"name\":\"A. Passerini\",\"url\":\"https://www.semanticscholar.org/author/145896191\"},{\"authorId\":\"1797956\",\"name\":\"R. Sebastiani\",\"url\":\"https://www.semanticscholar.org/author/1797956\"},{\"authorId\":\"1740042\",\"name\":\"L. D. Raedt\",\"url\":\"https://www.semanticscholar.org/author/1740042\"}],\"citationVelocity\":0,\"citations\":[{\"arxivId\":\"1909.09362\",\"authors\":[{\"authorId\":\"14875676\",\"name\":\"Z. Zeng\"},{\"authorId\":\"1389041714\",\"name\":\"Fanqi Yan\"},{\"authorId\":\"2047325\",\"name\":\"Paolo Morettin\"},{\"authorId\":\"14341992\",\"name\":\"A. Vergari\"},{\"authorId\":\"1749506\",\"name\":\"Guy Van den Broeck\"}],\"doi\":null,\"intent\":[\"background\"],\"isInfluential\":false,\"paperId\":\"c432cdafe7c67207256a932c9d65e2c334f4e63a\",\"title\":\"Hybrid Probabilistic Inference with Logical Constraints: Tractability and Message Passing\",\"url\":\"https://www.semanticscholar.org/paper/c432cdafe7c67207256a932c9d65e2c334f4e63a\",\"venue\":\"ArXiv\",\"year\":2019},{\"arxivId\":\"2003.00126\",\"authors\":[{\"authorId\":\"1474573543\",\"name\":\"Zhe Zeng\"},{\"authorId\":\"2047325\",\"name\":\"Paolo Morettin\"},{\"authorId\":\"1389041714\",\"name\":\"Fanqi Yan\"},{\"authorId\":\"14341992\",\"name\":\"A. Vergari\"},{\"authorId\":\"1749506\",\"name\":\"Guy Van den Broeck\"}],\"doi\":null,\"intent\":[],\"isInfluential\":false,\"paperId\":\"37e850fc460da7aac7aeffc2f27825e2d91ee2ab\",\"title\":\"Scaling up Hybrid Probabilistic Inference with Logical and Arithmetic Constraints via Message Passing\",\"url\":\"https://www.semanticscholar.org/paper/37e850fc460da7aac7aeffc2f27825e2d91ee2ab\",\"venue\":\"ICML\",\"year\":2020},{\"arxivId\":null,\"authors\":[{\"authorId\":\"1482586433\",\"name\":\"Zhe Zeng\"},{\"authorId\":\"2047325\",\"name\":\"Paolo Morettin\"},{\"authorId\":\"1389041714\",\"name\":\"Fanqi Yan\"},{\"authorId\":\"14341992\",\"name\":\"A. Vergari\"},{\"authorId\":\"1749506\",\"name\":\"Guy Van den Broeck\"}],\"doi\":null,\"intent\":[\"background\"],\"isInfluential\":false,\"paperId\":\"227276baac7f83c3e6d7e4c0bb2ffe8457c4ec80\",\"title\":\"Relax, compensate and then integrate\",\"url\":\"https://www.semanticscholar.org/paper/227276baac7f83c3e6d7e4c0bb2ffe8457c4ec80\",\"venue\":\"\",\"year\":2020},{\"arxivId\":null,\"authors\":[{\"authorId\":\"30698192\",\"name\":\"Samuel Kolb\"},{\"authorId\":\"51007563\",\"name\":\"Pedro Zuidberg Dos Martires\"},{\"authorId\":\"1740042\",\"name\":\"L. D. Raedt\"}],\"doi\":null,\"intent\":[],\"isInfluential\":false,\"paperId\":\"229bdb8e6db108cfd6f0a4cd2d6b4bdd5a11fbe4\",\"title\":\"How to Exploit Structure while Solving Weighted Model Integration Problems\",\"url\":\"https://www.semanticscholar.org/paper/229bdb8e6db108cfd6f0a4cd2d6b4bdd5a11fbe4\",\"venue\":\"UAI\",\"year\":2019},{\"arxivId\":null,\"authors\":[{\"authorId\":\"1419494027\",\"name\":\"Vincent Derkinderen\"},{\"authorId\":\"1958996932\",\"name\":\"Evert Heylen\"},{\"authorId\":\"51007563\",\"name\":\"Pedro Zuidberg Dos Martires\"},{\"authorId\":\"30698192\",\"name\":\"Samuel Kolb\"},{\"authorId\":\"1740042\",\"name\":\"L. D. Raedt\"}],\"doi\":null,\"intent\":[],\"isInfluential\":false,\"paperId\":\"cb9a001d1ab4a2f1f73dd418aac3172bffd374d9\",\"title\":\"Ordering Variables for Weighted Model Integration\",\"url\":\"https://www.semanticscholar.org/paper/cb9a001d1ab4a2f1f73dd418aac3172bffd374d9\",\"venue\":\"UAI\",\"year\":2020},{\"arxivId\":null,\"authors\":[{\"authorId\":\"1482586433\",\"name\":\"Zhe Zeng\"},{\"authorId\":\"2047325\",\"name\":\"Paolo Morettin\"},{\"authorId\":\"1389041714\",\"name\":\"Fanqi Yan\"},{\"authorId\":\"14341992\",\"name\":\"A. Vergari\"},{\"authorId\":\"1749506\",\"name\":\"Guy Van den Broeck\"}],\"doi\":null,\"intent\":[\"methodology\"],\"isInfluential\":false,\"paperId\":\"3a0e01530070106448ed84ee4738bf4f005236db\",\"title\":\"Probabilistic Inference with Algebraic Constraints: Theoretical Limits and Practical Approximations\",\"url\":\"https://www.semanticscholar.org/paper/3a0e01530070106448ed84ee4738bf4f005236db\",\"venue\":\"NeurIPS\",\"year\":2020},{\"arxivId\":\"2006.08480\",\"authors\":[{\"authorId\":\"144893617\",\"name\":\"V. Belle\"}],\"doi\":\"10.1007/978-3-030-58449-8_1\",\"intent\":[\"background\"],\"isInfluential\":false,\"paperId\":\"eb9f7d4cbee332223895e1b2a0065a4d30bdb899\",\"title\":\"Symbolic Logic meets Machine Learning: A Brief Survey in Infinite Domains\",\"url\":\"https://www.semanticscholar.org/paper/eb9f7d4cbee332223895e1b2a0065a4d30bdb899\",\"venue\":\"SUM\",\"year\":2020}],\"corpusId\":199465759,\"doi\":\"10.24963/ijcai.2019/946\",\"fieldsOfStudy\":[\"Computer Science\"],\"influentialCitationCount\":0,\"is_open_access\":true,\"is_publisher_licensed\":false,\"paperId\":\"5cb62a5d3fc16012601aa119ccf53b3fdc27d952\",\"references\":[{\"arxivId\":null,\"authors\":[{\"authorId\":null,\"name\":\"Ciaran O\\u2019Reilly\"}],\"doi\":null,\"intent\":[],\"isInfluential\":false,\"paperId\":\"\",\"title\":\", Vibhav Gogate , and Rina Dechter . Probabilistic inference modulo theories Problog 2 : Probabilistic logic programming\",\"url\":\"\",\"venue\":\"\",\"year\":2015},{\"arxivId\":null,\"authors\":[{\"authorId\":\"1680661\",\"name\":\"C. Barrett\"},{\"authorId\":\"145041674\",\"name\":\"A. Stump\"},{\"authorId\":\"35116359\",\"name\":\"C. Tinelli\"}],\"doi\":null,\"intent\":[],\"isInfluential\":false,\"paperId\":\"ae4ff80d08627cc4e242968fa8059d9b49bf0d55\",\"title\":\"The SMT-LIB Standard Version 2.0\",\"url\":\"https://www.semanticscholar.org/paper/ae4ff80d08627cc4e242968fa8059d9b49bf0d55\",\"venue\":\"\",\"year\":2010},{\"arxivId\":null,\"authors\":[{\"authorId\":\"144893617\",\"name\":\"V. Belle\"},{\"authorId\":\"145896191\",\"name\":\"A. Passerini\"},{\"authorId\":\"1749506\",\"name\":\"Guy Van den Broeck\"}],\"doi\":null,\"intent\":[],\"isInfluential\":false,\"paperId\":\"90edef0248724e46cf53efef6fe4fe9598a6c91b\",\"title\":\"Probabilistic Inference in Hybrid Domains by Weighted Model Integration\",\"url\":\"https://www.semanticscholar.org/paper/90edef0248724e46cf53efef6fe4fe9598a6c91b\",\"venue\":\"IJCAI\",\"year\":2015},{\"arxivId\":\"1202.3762\",\"authors\":[{\"authorId\":\"1732536\",\"name\":\"S. Sanner\"},{\"authorId\":\"1921789\",\"name\":\"K. Delgado\"},{\"authorId\":\"143844870\",\"name\":\"L. Barros\"}],\"doi\":null,\"intent\":[],\"isInfluential\":false,\"paperId\":\"d71462ee5050022b7a59189b78dae2203682d562\",\"title\":\"Symbolic Dynamic Programming for Discrete and Continuous State MDPs\",\"url\":\"https://www.semanticscholar.org/paper/d71462ee5050022b7a59189b78dae2203682d562\",\"venue\":\"UAI\",\"year\":2011},{\"arxivId\":null,\"authors\":[{\"authorId\":\"1707364\",\"name\":\"A. Dries\"},{\"authorId\":\"3294328\",\"name\":\"A. Kimmig\"},{\"authorId\":\"1718583\",\"name\":\"Wannes Meert\"},{\"authorId\":\"3267970\",\"name\":\"Joris Renkens\"},{\"authorId\":\"1749506\",\"name\":\"Guy Van den Broeck\"},{\"authorId\":\"1720975\",\"name\":\"Jonas Vlasselaer\"},{\"authorId\":\"1740042\",\"name\":\"L. D. Raedt\"}],\"doi\":\"10.1007/978-3-319-23461-8_37\",\"intent\":[],\"isInfluential\":false,\"paperId\":\"c32612d39403ade9ef33ae764876f43f833c3a59\",\"title\":\"ProbLog2: Probabilistic Logic Programming\",\"url\":\"https://www.semanticscholar.org/paper/c32612d39403ade9ef33ae764876f43f833c3a59\",\"venue\":\"ECML/PKDD\",\"year\":2015},{\"arxivId\":null,\"authors\":[{\"authorId\":\"3185535\",\"name\":\"N. Nethercote\"},{\"authorId\":\"1682747\",\"name\":\"Peter James Stuckey\"},{\"authorId\":\"3122326\",\"name\":\"R. Becket\"},{\"authorId\":\"46525444\",\"name\":\"S. Brand\"},{\"authorId\":\"1747521\",\"name\":\"G. Duck\"},{\"authorId\":\"38448160\",\"name\":\"G. Tack\"}],\"doi\":\"10.1007/978-3-540-74970-7_38\",\"intent\":[],\"isInfluential\":false,\"paperId\":\"01957c9c91ea40a8ad5ab5a12d694a85c53a956e\",\"title\":\"MiniZinc: Towards a Standard CP Modelling Language\",\"url\":\"https://www.semanticscholar.org/paper/01957c9c91ea40a8ad5ab5a12d694a85c53a956e\",\"venue\":\"CP\",\"year\":2007},{\"arxivId\":null,\"authors\":[{\"authorId\":\"2959734\",\"name\":\"Timon Gehr\"},{\"authorId\":\"1704478\",\"name\":\"S. Misailovic\"},{\"authorId\":\"1736447\",\"name\":\"Martin T. Vechev\"}],\"doi\":\"10.1007/978-3-319-41528-4_4\",\"intent\":[],\"isInfluential\":false,\"paperId\":\"9b09341d63284351e80c95d3a80c4c241a3d8ed5\",\"title\":\"PSI: Exact Symbolic Inference for Probabilistic Programs\",\"url\":\"https://www.semanticscholar.org/paper/9b09341d63284351e80c95d3a80c4c241a3d8ed5\",\"venue\":\"CAV\",\"year\":2016},{\"arxivId\":null,\"authors\":[{\"authorId\":\"30698192\",\"name\":\"Samuel Kolb\"},{\"authorId\":\"2538104\",\"name\":\"M. Mladenov\"},{\"authorId\":\"1732536\",\"name\":\"S. Sanner\"},{\"authorId\":\"144893617\",\"name\":\"V. Belle\"},{\"authorId\":\"1746871\",\"name\":\"K. Kersting\"}],\"doi\":\"10.24963/ijcai.2018/698\",\"intent\":[],\"isInfluential\":false,\"paperId\":\"85c51b4e40245c569ab0a2ad6f744682105a8bd1\",\"title\":\"Efficient Symbolic Integration for Probabilistic Inference\",\"url\":\"https://www.semanticscholar.org/paper/85c51b4e40245c569ab0a2ad6f744682105a8bd1\",\"venue\":\"IJCAI\",\"year\":2018},{\"arxivId\":null,\"authors\":[{\"authorId\":\"51007563\",\"name\":\"Pedro Zuidberg Dos Martires\"},{\"authorId\":\"1707364\",\"name\":\"A. Dries\"},{\"authorId\":\"1740042\",\"name\":\"L. D. Raedt\"}],\"doi\":\"10.1609/AAAI.V33I01.33017825\",\"intent\":[],\"isInfluential\":false,\"paperId\":\"172958ac1913d552948d74c8d88a7ebb6ad21695\",\"title\":\"Exact and Approximate Weighted Model Integration with Probability Density Functions Using Knowledge Compilation\",\"url\":\"https://www.semanticscholar.org/paper/172958ac1913d552948d74c8d88a7ebb6ad21695\",\"venue\":\"AAAI\",\"year\":2019},{\"arxivId\":\"1605.08367\",\"authors\":[{\"authorId\":\"2413558\",\"name\":\"Rodrigo de Salvo Braz\"},{\"authorId\":null,\"name\":\"Ciaran O'Reilly\"},{\"authorId\":\"143754991\",\"name\":\"V. Gogate\"},{\"authorId\":\"1751239\",\"name\":\"R. Dechter\"}],\"doi\":null,\"intent\":[],\"isInfluential\":false,\"paperId\":\"047ff7d712e0300e0842f16122451bb2ccf86a11\",\"title\":\"Probabilistic Inference Modulo Theories\",\"url\":\"https://www.semanticscholar.org/paper/047ff7d712e0300e0842f16122451bb2ccf86a11\",\"venue\":\"IJCAI\",\"year\":2016},{\"arxivId\":null,\"authors\":[{\"authorId\":\"2047325\",\"name\":\"Paolo Morettin\"},{\"authorId\":\"1702610\",\"name\":\"Andrea Passerini\"},{\"authorId\":\"1797956\",\"name\":\"R. Sebastiani\"}],\"doi\":\"10.1016/J.ARTINT.2019.04.003\",\"intent\":[],\"isInfluential\":false,\"paperId\":\"1a7993988cf3eed3fc54bd1be93aa413b2cf8940\",\"title\":\"Advanced SMT techniques for weighted model integration\",\"url\":\"https://www.semanticscholar.org/paper/1a7993988cf3eed3fc54bd1be93aa413b2cf8940\",\"venue\":\"Artif. Intell.\",\"year\":2019},{\"arxivId\":null,\"authors\":[{\"authorId\":\"2260705\",\"name\":\"M. Gario\"},{\"authorId\":\"50726480\",\"name\":\"A. Micheli\"},{\"authorId\":\"39392131\",\"name\":\"B. Kessler\"}],\"doi\":null,\"intent\":[],\"isInfluential\":false,\"paperId\":\"319a91ae78fc5d933252de08daa25e6dcb4cc758\",\"title\":\"PySMT: a Solver-Agnostic Library for Fast Prototyping of SMT-Based Algorithms\",\"url\":\"https://www.semanticscholar.org/paper/319a91ae78fc5d933252de08daa25e6dcb4cc758\",\"venue\":\"\",\"year\":2015},{\"arxivId\":\"1108.0117\",\"authors\":[{\"authorId\":\"2535456\",\"name\":\"J. D. Loera\"},{\"authorId\":\"145308921\",\"name\":\"B. Dutra\"},{\"authorId\":\"2867583\",\"name\":\"M. K\\u00f6ppe\"},{\"authorId\":\"2262576\",\"name\":\"S. Moreinis\"},{\"authorId\":\"145380241\",\"name\":\"G. Pinto\"},{\"authorId\":\"46365326\",\"name\":\"J. Wu\"}],\"doi\":\"10.1016/j.comgeo.2012.09.001\",\"intent\":[],\"isInfluential\":false,\"paperId\":\"1238c3dad07a5f0e8a6a640ea5094e1d55b5890d\",\"title\":\"Software for exact integration of polynomials over polyhedra\",\"url\":\"https://www.semanticscholar.org/paper/1238c3dad07a5f0e8a6a640ea5094e1d55b5890d\",\"venue\":\"Comput. Geom.\",\"year\":2013}],\"title\":\"The pywmi Framework and Toolbox for Probabilistic Inference using Weighted Model Integration\",\"topics\":[{\"topic\":\"Constraint programming\",\"topicId\":\"7022\",\"url\":\"https://www.semanticscholar.org/topic/7022\"},{\"topic\":\"Command-line interface\",\"topicId\":\"105025\",\"url\":\"https://www.semanticscholar.org/topic/105025\"},{\"topic\":\"Solver\",\"topicId\":\"6215\",\"url\":\"https://www.semanticscholar.org/topic/6215\"},{\"topic\":\"Modeling language\",\"topicId\":\"14688\",\"url\":\"https://www.semanticscholar.org/topic/14688\"},{\"topic\":\"Document Object Model\",\"topicId\":\"76499\",\"url\":\"https://www.semanticscholar.org/topic/76499\"},{\"topic\":\"International Joint Conference on Artificial Intelligence\",\"topicId\":\"453638\",\"url\":\"https://www.semanticscholar.org/topic/453638\"},{\"topic\":\"Weight function\",\"topicId\":\"14752\",\"url\":\"https://www.semanticscholar.org/topic/14752\"},{\"topic\":\"Parsing\",\"topicId\":\"1910\",\"url\":\"https://www.semanticscholar.org/topic/1910\"},{\"topic\":\"Simultaneous multithreading\",\"topicId\":\"85071\",\"url\":\"https://www.semanticscholar.org/topic/85071\"},{\"topic\":\"Boolean satisfiability problem\",\"topicId\":\"119956\",\"url\":\"https://www.semanticscholar.org/topic/119956\"},{\"topic\":\"Possible world\",\"topicId\":\"50627\",\"url\":\"https://www.semanticscholar.org/topic/50627\"},{\"topic\":\"Linear inequality\",\"topicId\":\"30909\",\"url\":\"https://www.semanticscholar.org/topic/30909\"},{\"topic\":\"Sharp-SAT\",\"topicId\":\"663134\",\"url\":\"https://www.semanticscholar.org/topic/663134\"},{\"topic\":\"Programming language\",\"topicId\":\"8202\",\"url\":\"https://www.semanticscholar.org/topic/8202\"},{\"topic\":\"Subroutine\",\"topicId\":\"60582\",\"url\":\"https://www.semanticscholar.org/topic/60582\"},{\"topic\":\"Open-source software\",\"topicId\":\"8878\",\"url\":\"https://www.semanticscholar.org/topic/8878\"},{\"topic\":\"Approximation algorithm\",\"topicId\":\"87\",\"url\":\"https://www.semanticscholar.org/topic/87\"},{\"topic\":\"Tracing (software)\",\"topicId\":\"2918\",\"url\":\"https://www.semanticscholar.org/topic/2918\"},{\"topic\":\"Belle (chess machine)\",\"topicId\":\"95668\",\"url\":\"https://www.semanticscholar.org/topic/95668\"},{\"topic\":\"Barrett reduction\",\"topicId\":\"854889\",\"url\":\"https://www.semanticscholar.org/topic/854889\"},{\"topic\":\"Python\",\"topicId\":\"3739\",\"url\":\"https://www.semanticscholar.org/topic/3739\"},{\"topic\":\"ENCODE\",\"topicId\":\"365717\",\"url\":\"https://www.semanticscholar.org/topic/365717\"},{\"topic\":\"Windows Media Center\",\"topicId\":\"703529\",\"url\":\"https://www.semanticscholar.org/topic/703529\"},{\"topic\":\"Abstract syntax tree\",\"topicId\":\"1274\",\"url\":\"https://www.semanticscholar.org/topic/1274\"}],\"url\":\"https://www.semanticscholar.org/paper/5cb62a5d3fc16012601aa119ccf53b3fdc27d952\",\"venue\":\"IJCAI\",\"year\":2019}\n"